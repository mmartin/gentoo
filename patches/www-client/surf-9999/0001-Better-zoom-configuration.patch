From 6c901103e80821f3bb1a247850c078b87cdca4a8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?M=C4=81rti=C5=86=C5=A1=20Ma=C4=8Ds?=
 <macs.martins@gmail.com>
Date: Tue, 27 Sep 2016 12:21:20 +0300
Subject: [PATCH 1/4] Better zoom configuration

---
 config.def.h |  2 +-
 surf.c       | 11 ++++++-----
 2 files changed, 7 insertions(+), 6 deletions(-)

diff --git a/config.def.h b/config.def.h
index 7c2b10f..a9fceaa 100644
--- a/config.def.h
+++ b/config.def.h
@@ -93,7 +93,7 @@ static Key keys[] = {
 
 	{ MODKEY|GDK_SHIFT_MASK,GDK_j,      zoom,       { .i = -1 } },
 	{ MODKEY|GDK_SHIFT_MASK,GDK_k,      zoom,       { .i = +1 } },
-	{ MODKEY|GDK_SHIFT_MASK,GDK_q,      zoom,       { .i = 0  } },
+	{ MODKEY|GDK_SHIFT_MASK,GDK_q,      zoom,       { .f =  1 } },
 	{ MODKEY,               GDK_minus,  zoom,       { .i = -1 } },
 	{ MODKEY,               GDK_plus,   zoom,       { .i = +1 } },
 
diff --git a/surf.c b/surf.c
index 46aef68..20b9fd8 100644
--- a/surf.c
+++ b/surf.c
@@ -51,6 +51,7 @@ typedef union Arg Arg;
 union Arg {
 	gboolean b;
 	gint i;
+	gfloat f;
 	const void *v;
 };
 
@@ -1689,16 +1690,16 @@ void
 zoom(Client *c, const Arg *arg)
 {
 	c->zoomed = TRUE;
-	if (arg->i < 0) {
+	if (arg->i == -1) {
 		/* zoom out */
 		webkit_web_view_zoom_out(c->view);
-	} else if (arg->i > 0) {
+	} else if (arg->i == +1) {
 		/* zoom in */
 		webkit_web_view_zoom_in(c->view);
 	} else {
-		/* reset */
-		c->zoomed = FALSE;
-		webkit_web_view_set_zoom_level(c->view, 1.0);
+		/* exact set */
+		c->zoomed = (arg->f != 1.0);
+		webkit_web_view_set_zoom_level(c->view, arg->f);
 	}
 }
 
-- 
2.7.3

